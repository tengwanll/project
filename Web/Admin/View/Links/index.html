<extend name="User/index" />
<block name="title">
    <title>友链列表</title>
</block>
<block name="css">
        <!-- Plugin Stylesheets first to ease overrides -->
    <link rel="stylesheet" type="text/css" href="__PUBLIC__/Admin/plugins/colorpicker/colorpicker.css" media="screen">
    <link rel="stylesheet" type="text/css" href="__PUBLIC__/Admin/custom-plugins/picklist/picklist.css" media="screen">
    <link rel="stylesheet" type="text/css" href="__PUBLIC__/Admin/plugins/select2/select2.css" media="screen">
    <link rel="stylesheet" type="text/css" href="__PUBLIC__/Admin/plugins/ibutton/jquery.ibutton.css" media="screen">
    <link rel="stylesheet" type="text/css" href="__PUBLIC__/Admin/plugins/cleditor/jquery.cleditor.css" media="screen">

    <!-- Required Stylesheets -->
    <link rel="stylesheet" type="text/css" href="__PUBLIC__/Admin/bootstrap/css/bootstrap.min.css" media="screen">
    <link rel="stylesheet" type="text/css" href="__PUBLIC__/Admin/css/fonts/ptsans/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="__PUBLIC__/Admin/css/fonts/icomoon/style.css" media="screen">

    <link rel="stylesheet" type="text/css" href="__PUBLIC__/Admin/css/mws-style.css" media="screen">
    <link rel="stylesheet" type="text/css" href="__PUBLIC__/Admin/css/icons/icol16.css" media="screen">
    <link rel="stylesheet" type="text/css" href="__PUBLIC__/Admin/css/icons/icol32.css" media="screen">

    <!-- Demo Stylesheet -->
    <link rel="stylesheet" type="text/css" href="__PUBLIC__/Admin/css/demo.css" media="screen">

    <!-- jQuery-UI Stylesheet -->
    <link rel="stylesheet" type="text/css" href="__PUBLIC__/Admin/jui/css/jquery.ui.all.css" media="screen">
    <link rel="stylesheet" type="text/css" href="__PUBLIC__/Admin/jui/jquery-ui.custom.css" media="screen">

    <!-- Theme Stylesheet -->
    <link rel="stylesheet" type="text/css" href="__PUBLIC__/Admin/css/mws-theme.css" media="screen">
    <link rel="stylesheet" type="text/css" href="__PUBLIC__/Admin/css/themer.css" media="screen">
</block>
<block name="con">
    <div class="mws-panel grid_8">
        <div class="mws-panel-header">
            <span><i class="icon-table"></i> 友情链接列表</span>
        </div>
        <div class="mws-form-message error" style="display:none">
            This is an error message
        </div>
        <div class="mws-form-message success" style="display:none">
            This is a success message
        </div>
        <div class="mws-panel-body no-padding">
            <div role="grid" class="dataTables_wrapper" id="DataTables_Table_1_wrapper">
                <form action="{:U('Links/index')}" method="get">
                    <div id="DataTables_Table_1_length" class="dataTables_length">
                        <label>显示
                            <select name="num" size="1" aria-controls="DataTables_Table_1">
                                <option value="2" <if condition="$num == 2">selected="selected"</if>>2</option>
                                <option value="5" <if condition="$num == 5">selected="selected"</if>>5</option>
                                <option value="10" <if condition="$num == 10">selected="selected"</if>>10</option>
                                <option value="20" <if condition="$num == 20">selected="selected"</if>>20</option>
                            </select> 数据
                        </label>
                    </div>
                <div class="dataTables_filter" id="DataTables_Table_1_filter">
                        <label>友情链接名: <input name="keyword" type="text" value="{$keyword}" aria-controls="DataTables_Table_1"></label><button class="btn " type="">搜索</button>
                        <a href="{:U('Links/add')}" class="btn ">添加</a>
                </div>
                </form>
                <table class="mws-datatable-fn mws-table dataTable" id="DataTables_Table_1" aria-describedby="DataTables_Table_1_info">
                <thead>
                    <tr role="row"><th class="sorting_asc" role="columnheader" tabindex="0" aria-controls="DataTables_Table_1" rowspan="1" colspan="1" style="width: 156px;" aria-sort="ascending" aria-label="Rendering engine: activate to sort column descending">ID</th><th class="sorting" role="columnheader" tabindex="0" aria-controls="DataTables_Table_1" rowspan="1" colspan="1" style="width: 212px;" aria-label="Browser: activate to sort column ascending">友情链接名</th><th class="sorting" role="columnheader" tabindex="0" aria-controls="DataTables_Table_1" rowspan="1" colspan="1" style="width: 197px;" aria-label="Platform(s): activate to sort column ascending">链接图片</th><th class="sorting" role="columnheader" tabindex="0" aria-controls="DataTables_Table_1" rowspan="1" colspan="1" style="width: 197px;" aria-label="Platform(s): activate to sort column ascending">链接类型</th><th class="sorting" role="columnheader" tabindex="0" aria-controls="DataTables_Table_1" rowspan="1" colspan="1" style="width: 197px;" aria-label="Platform(s): activate to sort column ascending">链接地址</th><th class="sorting" role="columnheader" tabindex="0" aria-controls="DataTables_Table_1" rowspan="1" colspan="1" style="width: 97px;" aria-label="CSS grade: activate to sort column ascending">状态</th><th class="sorting" role="columnheader" tabindex="0" aria-controls="DataTables_Table_1" rowspan="1" colspan="1" style="width: 97px;" aria-label="CSS grade: activate to sort column ascending">操作</th></tr>
                </thead>
                    
                <tbody role="alert" aria-live="polite" aria-relevant="all">
                <foreach name="links" item="vo" >
                <tr class="<if condition="$key % 2 == 0">even<else />odd</if>">
                    <td class="  sorting_1">{$vo['id']}</td>
                    <td class=" ">{$vo['name']}</td>
                    <if condition="$vo['type'] neq '0' ">
                    <td class=" "><img src="__ROOT__{$vo['img']}" alt="" style="width:60px;"></td>
                    <else />
                    <td class=" "></td>
                    </if>
                    <td class=" ">{$vo['type']|getLinkType}</td>
                    <td class=" ">{$vo['link']}</td>
                    <td class=" " style="text-align:center">
                        <input name="" class="ibutton" type="checkbox"  <if condition="$vo['status'] == 1">checked="checked"</if> >
                    </td>
                    <td class=" " style="text-align:center">
                        <a class="btn btn-small" href="{:U('Links/edit', array('id'=>$vo['id']))}"><i class="icon-pencil" style="width:5px"></i></a>
                        <a class="btn btn-small" href="{:U('Links/delete', array('id'=>$vo['id']))}"><i class="icon-trash" style="width:5px"></i></a>
                    </td>
                </tr>
                </foreach>
                </tbody>
                </table>
                <div class="dataTables_paginate paging_full_numbers" id="DataTables_Table_1_paginate">
                    <style type="text/css">
                        span .current,span a{
                            background-image: none;
                            border: medium none;
                            box-shadow: 0 0 4px rgba(0, 0, 0, 0.25) inset;
                            color: #323232;
                            background-color: #444444;
                            border-left: 1px solid rgba(255, 255, 255, 0.15);
                            border-right: 1px solid rgba(0, 0, 0, 0.5);
                            box-shadow: 0 1px 0 rgba(0, 0, 0, 0.5), 0 1px 0 rgba(255, 255, 255, 0.15) inset;
                            color: #fff;
                            cursor: pointer;
                            display: block;
                            float: left;
                            font-size: 12px;
                            height: 20px;
                            line-height: 20px;
                            outline: medium none;
                            padding: 0 10px;
                            text-align: center;
                            text-decoration: none;
                        }
                        span .current{
                            background-color:#c5d52b;
                            color: #323232;
                        }
                    </style>
                    <span>
                    
                        {$pages}

                    </span>
                </div>
            </div>
        </div>
    </div>

    
</block>
<block name="js">
    <!-- JavaScript Plugins -->
    <script src="__PUBLIC__/Admin/js/libs/jquery-1.8.3.min.js"></script>
    <script src="__PUBLIC__/Admin/js/libs/jquery.mousewheel.min.js"></script>
    <script src="__PUBLIC__/Admin/js/libs/jquery.placeholder.min.js"></script>
    <script src="__PUBLIC__/Admin/custom-plugins/fileinput.js"></script>
    
    <!-- jQuery-UI Dependent Scripts -->
    <script src="__PUBLIC__/Admin/jui/js/jquery-ui-1.9.2.min.js"></script>
    <script src="__PUBLIC__/Admin/jui/jquery-ui.custom.min.js"></script>
    <script src="__PUBLIC__/Admin/jui/js/jquery.ui.touch-punch.js"></script>

    <script src="__PUBLIC__/Admin/jui/js/globalize/globalize.js"></script>
    <script src="__PUBLIC__/Admin/jui/js/globalize/cultures/globalize.culture.en-US.js"></script>

    <!-- Plugin Scripts -->
    <script src="__PUBLIC__/Admin/custom-plugins/picklist/picklist.min.js"></script>
    <script src="__PUBLIC__/Admin/plugins/autosize/jquery.autosize.min.js"></script>
    <script src="__PUBLIC__/Admin/plugins/select2/select2.min.js"></script>
    <script src="__PUBLIC__/Admin/plugins/colorpicker/colorpicker-min.js"></script>
    <script src="__PUBLIC__/Admin/plugins/validate/jquery.validate-min.js"></script>
    <script src="__PUBLIC__/Admin/plugins/ibutton/jquery.ibutton.min.js"></script>
    <script src="__PUBLIC__/Admin/plugins/cleditor/jquery.cleditor.min.js"></script>
    <script src="__PUBLIC__/Admin/plugins/cleditor/jquery.cleditor.table.min.js"></script>
    <script src="__PUBLIC__/Admin/plugins/cleditor/jquery.cleditor.xhtml.min.js"></script>
    <script src="__PUBLIC__/Admin/plugins/cleditor/jquery.cleditor.icon.min.js"></script>

    <!-- Core Script -->
    <script src="__PUBLIC__/Admin/bootstrap/js/bootstrap.min.js"></script>
    <script src="__PUBLIC__/Admin/js/core/mws.js"></script>

    <!-- Themer Script (Remove if not needed) -->
    <script src="__PUBLIC__/Admin/js/core/themer.js"></script>

    <!-- Demo Scripts (remove if not needed) -->
    <script src="__PUBLIC__/Admin/js/demo/demo.formelements.js"></script>
    <script type="text/javascript">
        //等按钮加载完毕之后绑定单击事件发送ajax
        $(function(){
            $('.ibutton-container').click(function(){
                //获得当前的状态
                var res = $(this).find('input').attr('checked');
                //获得当前的数据ID
                var id = $(this).parents('tr').find('td:first-child').text();
                //根据点击的情况获得aja请求的status值
                var status = res ? 1 : 0;
                //发送ajax请求
                $.post("{:U('Links/ajaxUpdate')}", {status:status, id:id}, function(data){
                    //如果执行成功
                    if(data == 0){
                        show('友链状态修改成功', 'success');
                    }else{
                        //如果执行失败
                        show('友链状态修改失败', 'error');
                    }
                });
                
            });
        });

        //定义显示的函数
        function show(mess, type){
            //获取对象
            var obj = $('.'+type);
            //设置文本
            obj.text(mess);
            //显示
            obj.show();
            //设置显示时间
            setTimeout(function(){
                obj.fadeOut();
            }, 3000);
        }
    </script>
</block>
<block name="myJs"></block>
