<extend name="User/index" />
<block name="title">
	<title>分类列表</title>
</block>
<block name="con">
    <div class="mws-panel grid_8">
        <div class="mws-panel-header">
            <span><i class="icon-table"></i>分类列表</span>
        </div>
        <div class="mws-form-message success" style="display:none">
                       
                    </div>
                    <div class="mws-form-message error" style="display:none">
                           
                    </div>
        <div class="mws-panel-body no-padding">
            <div role="grid" class="dataTables_wrapper" id="DataTables_Table_1_wrapper">
                <form action="{:U('Cate/index')}" method="get">
                    <div id="DataTables_Table_1_length" class="dataTables_length">
                        <label>显示
                            <select name="num" id='abc' size="1" aria-controls="DataTables_Table_1">
                                <option  value="5" <if condition="$num == 5">selected="selected"</if>>5</option>
                                <option  value="10" <if condition="$num == 10">selected="selected"</if>>10</option>
                                <option  value="15" <if condition="$num == 15">selected="selected"</if>>15</option>
                                <option  value="20" <if condition="$num == 20">selected="selected"</if>>20</option>
                            </select> 数据
                        </label>
                    </div>
                <div class="dataTables_filter" id="DataTables_Table_1_filter">
                        <label>分类名: <input name="keywords" type="text" value="{$keywords}" aria-controls="DataTables_Table_1"></label><button class="btn" type="">搜索</button>
                </div>
                </form>
                <table class="mws-datatable-fn mws-table dataTable" id="DataTables_Table_1" aria-describedby="DataTables_Table_1_info">
                <thead>
                    <tr role="row">
                        <th class="sorting_asc" role="columnheader" tabindex="0" aria-controls="DataTables_Table_1" rowspan="1" colspan="1" style="width: 156px;" aria-sort="ascending" aria-label="Rendering engine: activate to sort column descending">ID</th>
                        <th class="sorting" role="columnheader" tabindex="0" aria-controls="DataTables_Table_1" rowspan="1" colspan="1" style="width: 212px;" aria-label="Browser: activate to sort column ascending">分类名</th>
                        <th class="sorting" role="columnheader" tabindex="0" aria-controls="DataTables_Table_1" rowspan="1" colspan="1" style="width: 197px;" aria-label="Platform(s): activate to sort column ascending">父类分类</th>
                        <th class="sorting" role="columnheader" tabindex="0" aria-controls="DataTables_Table_1" rowspan="1" colspan="1" style="width: 97px;" aria-label="CSS grade: activate to sort column ascending">是否启用</th>
                        <th class="sorting" role="columnheader" tabindex="0" aria-controls="DataTables_Table_1" rowspan="1" colspan="1" style="width: 97px;" aria-label="CSS grade: activate to sort column ascending">操作</th>
                    </tr>
                </thead>
                    
                <tbody role="alert" aria-live="polite" aria-relevant="all">
                <foreach name="sorts" item="vo" >
                <tr class="<if condition="$key % 2 == 0">even<else />odd</if>">
                    <td class="  sorting_1">{$vo['id']}</td>
                    <td class=" ">{$vo['name']}</td>
                    <td class=" ">{$vo['sid']|getName}</td>
                    
                    
                    <td class=''>
                        <div class="mws-form-item">
                            <input class="ibutton" type="checkbox" <if condition="$vo['status'] ==0">checked="checked"</if>>
                                           
                        </div>
                    </td>
                    <td class=" " style="text-align:center">

                    <!-- 修改 -->
                        <a class="btn btn-small" href="{:U('Cate/edit', array('id'=>$vo['id']))}"><i class="icon-pencil" style="width:6px"></i></a>
                        <!-- 删除 -->
                        <a class="btn btn-small" href="{:U('Cate/delete', array('id'=>$vo['id']))}"><i class="icon-trash" style="width:8px"></i></a>
                    </td>
                </tr>
                </foreach>
                </tbody>
                </table>

                

                <div class="dataTables_paginate paging_full_numbers" id="DataTables_Table_1_paginate">
                    <style type="text/css">
                        span .current,span a{
                            background-image: none;
                            border: medium none;
                            box-shadow: 0 0 4px rgba(0, 0, 0, 0.25) inset;
                            color: #323232;
                            background-color: #444444;
                            border-left: 1px solid rgba(255, 255, 255, 0.15);
                            border-right: 1px solid rgba(0, 0, 0, 0.5);
                            box-shadow: 0 1px 0 rgba(0, 0, 0, 0.5), 0 1px 0 rgba(255, 255, 255, 0.15) inset;
                            color: #fff;
                            cursor: pointer;
                            display: block;
                            float: left;
                            font-size: 12px;
                            height: 20px;
                            line-height: 20px;
                            outline: medium none;
                            padding: 0 10px;
                            text-align: center;
                            text-decoration: none;
                        }
                        span .current{
                            background-color:#c5d52b;
                            color: #323232;
                        }
                    </style>
                    <span>
                    
                        {$pages}

                    </span>
                </div>
            </div>
        </div>
    </div>
    <script src="__PUBLIC__/Admin/js/libs/jquery-1.8.3.min.js"></script>

</block>
<block name="myJs">
    <script type="text/javascript">

    //自定义show函数
       function show(str,status){

        //获取对象
        var obj = $('.'+status);
        //设置文本
        obj.html(str);

        //显示
        obj.css('display','block');

        //3秒后隐藏起来
        setTimeout(function(){
            obj.fadeOut();
        },500);

       }

    //获取ibutton的状态
    $('.mws-form-item').click(function(){

        //获取当前的状态
        var res = $(this).find('.ibutton').attr('checked');

        
       //获取id
       var id = $(this).parents('tr').find('td:nth-child(1)').html();

       var status = res ? 1 : 0;

       //发送ajax请求
       $.post("{:U('Admin/Cate/ajaxUpdate')}",{id:id,status:status},function(data){
        // console.log(data);
        if(data == 0){

            show('更新成功','success');
            // console.log('ok');
        }else{

            show('更新失败','error');
            // console.log(' not ok');
            
        }

       });

    });

    
    </script>
    </block>